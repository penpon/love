<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç¿’æ–¹å¼é¸æŠ - CSå­¦ç¿’ã‚¯ã‚¤ã‚ºãƒãƒˆãƒ«</title>
    <link rel="stylesheet" href="css/taisho.css">
</head>
<body>
    <!-- å››å­£ã®è£…é£¾è¦ç´  -->
    <div class="seasonal-decoration" id="seasonalDecoration"></div>

    <main class="washi-container wa-fade-in">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="wa-header">
            <h1 class="wa-title">å­¦ç¿’ã®é“ã‚’é¸ã¶</h1>
            <p class="wa-subtitle">ç¾ã—ãçŸ¥è­˜ã¸ã®äºŒã¤ã®æ‰‰</p>
            <div class="wa-divider"></div>
        </header>

        <!-- ãƒ«ãƒ¼ãƒ æƒ…å ±è¡¨ç¤º -->
        <div class="wa-room-info">
            <div class="wa-info-grid">
                <div class="wa-info-item">
                    <span class="wa-info-icon">ğŸ®</span>
                    <span class="wa-info-label">ãƒ«ãƒ¼ãƒ </span>
                    <span class="wa-info-value" id="roomName">-</span>
                </div>
                <div class="wa-info-item">
                    <span class="wa-info-icon" id="roleIcon">ğŸ‘‘</span>
                    <span class="wa-info-label">å½¹å‰²</span>
                    <span class="wa-info-value" id="roleName">ä¸»å‚¬è€…</span>
                </div>
                <div class="wa-info-item">
                    <span class="wa-info-icon">ğŸ­</span>
                    <span class="wa-info-label">ãŠåå‰</span>
                    <span class="wa-info-value" id="playerName">-</span>
                </div>
                <div class="wa-info-item">
                    <span class="wa-info-icon">ğŸ‘¥</span>
                    <span class="wa-info-label">å‚åŠ è€…</span>
                    <span class="wa-info-value" id="participantCount">2å</span>
                </div>
            </div>
        </div>

        <!-- ãƒ¢ãƒ¼ãƒ‰é¸æŠ -->
        <section class="wa-mode-selection-main">
            <h2 class="wa-section-title">ğŸŒ¸ å­¦ç¿’ã®æ–¹å¼ã‚’ãŠé¸ã³ãã ã•ã„</h2>
            
            <div class="wa-mode-cards-large">
                <!-- å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ -->
                <div class="wa-mode-card-large" onclick="selectMode('learning')" data-mode="learning">
                    <div class="wa-mode-decoration">
                        <div class="wa-decoration-element">ğŸŒ¸</div>
                        <div class="wa-decoration-element">ğŸ“œ</div>
                        <div class="wa-decoration-element">ğŸ’</div>
                    </div>
                    
                    <div class="wa-mode-icon-large">ğŸ“š</div>
                    <h3 class="wa-mode-title-large">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</h3>
                    <p class="wa-mode-subtitle">ç¾ã—ãç‰©èªã§å­¦ã¶CS</p>
                    
                    <div class="wa-mode-description-large">
                        æ‹æ„›ç‰©èªã«åŒ…ã¾ã‚ŒãªãŒã‚‰ã€<br>
                        ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®ç¥é«„ã‚’<br>
                        å„ªé›…ã«ç¿’å¾—ã„ãŸã—ã¾ã™
                    </div>
                    
                </div>

                <!-- ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰ -->
                <div class="wa-mode-card-large" onclick="selectMode('quiz')" data-mode="quiz">
                    <div class="wa-mode-decoration">
                        <div class="wa-decoration-element">âš”ï¸</div>
                        <div class="wa-decoration-element">ğŸ†</div>
                        <div class="wa-decoration-element">âš¡</div>
                    </div>
                    
                    <div class="wa-mode-icon-large">âš”ï¸</div>
                    <h3 class="wa-mode-title-large">ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰</h3>
                    <p class="wa-mode-subtitle">è¯éº—ãªã‚‹çŸ¥è­˜ã®å¯¾æˆ¦</p>
                    
                    <div class="wa-mode-description-large">
                        å­¦ã³ã—çŸ¥è­˜ã‚’æ­¦å™¨ã¨ã—ã¦ã€<br>
                        ç·Šå¼µæ„Ÿã‚ãµã‚Œã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¯¾æˆ¦ã§<br>
                        äº’ã„ã®å®ŸåŠ›ã‚’ç«¶ã„åˆã„ã¾ã™
                    </div>
                    
                </div>
            </div>

            <!-- é–‹å§‹ãƒœã‚¿ãƒ³ -->
            <div class="wa-btn-group-large">
                <button class="wa-btn wa-btn-outline" onclick="goBack()">
                    <span>ğŸ”™</span>
                    <span>å‰ã®ç”»é¢ã«æˆ»ã‚‹</span>
                </button>
                <button class="wa-btn wa-btn-primary wa-btn-large" id="startBtn" onclick="startSelectedMode()" disabled>
                    <span id="startIcon">ğŸŒ¸</span>
                    <span id="startText">å­¦ç¿’ã®æ‰‰ã‚’é–‹ã</span>
                </button>
            </div>
        </section>

        <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ -->
        <div class="wa-status">
            <div class="wa-status-item">
                <span class="wa-status-dot connected"></span>
                <span>æ¥ç¶šçŠ¶æ…‹: æº–å‚™å®Œäº†</span>
            </div>
            <div class="wa-status-item">
                <span>ğŸŒ é¸æŠçŠ¶æ…‹: <span id="statusSelection">æœªé¸æŠ</span></span>
            </div>
            <div class="wa-status-item">
                <span>â° å¾…æ©Ÿæ™‚é–“: <span id="waitingTime">00:00</span></span>
            </div>
        </div>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script src="js/socket.js"></script>
    <script>
        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰æƒ…å ±ã‚’å–å¾—
        const urlParams = new URLSearchParams(window.location.search);
        const userRole = urlParams.get('role') || 'owner';
        const roomId = urlParams.get('roomId') || '';
        const playerName = urlParams.get('playerName') || '';
        
        let selectedMode = '';
        let socket = null;
        let startTime = Date.now();
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            setupPageInfo();
            generateSeasonalElements();
            startWaitingTimer();
            initializeSocket();
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è»½æ¸›è¨­å®šã®ç¢ºèª
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.getElementById('seasonalDecoration').style.display = 'none';
                document.querySelectorAll('.wa-decoration-element').forEach(el => {
                    el.style.animation = 'none';
                });
            }
        });
        
        // ãƒšãƒ¼ã‚¸æƒ…å ±ã®è¨­å®š
        function setupPageInfo() {
            document.getElementById('roomName').textContent = roomId;
            document.getElementById('playerName').textContent = playerName;
            
            if (userRole === 'owner') {
                document.getElementById('roleIcon').textContent = 'ğŸ‘‘';
                document.getElementById('roleName').textContent = 'ä¸»å‚¬è€…';
            } else {
                document.getElementById('roleIcon').textContent = 'ğŸ‹';
                document.getElementById('roleName').textContent = 'å‚åŠ è€…';
            }
        }
        
        // Socket.ioåˆæœŸåŒ–
        function initializeSocket() {
            socket = io();
            
            socket.on('connect', () => {
                console.log('ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ã§ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶š');
                // ãƒ«ãƒ¼ãƒ å†å‚åŠ 
                socket.emit('join_room', {
                    roomId: roomId,
                    playerName: playerName,
                    role: userRole
                });
            });
            
            socket.on('room_status', (data) => {
                const playerCount = data.players ? data.players.length : 0;
                document.getElementById('participantCount').textContent = `${playerCount}å`;
            });
            
            socket.on('mode_selected', (data) => {
                if (userRole === 'guest' && data.mode) {
                    // Guestã®å ´åˆã¯å¼·åˆ¶çš„ã«åŒã˜ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ
                    selectedMode = data.mode;
                    updateSelectedMode(data.mode, true);
                }
            });
            
            socket.on('mode_started', (data) => {
                // ãƒ¢ãƒ¼ãƒ‰é–‹å§‹ã®é€šçŸ¥ã‚’å—ã‘ãŸå ´åˆ
                proceedToSelectedMode(data.mode, data);
            });
        }
        
        // ãƒ¢ãƒ¼ãƒ‰é¸æŠ
        function selectMode(mode) {
            if (userRole === 'guest') {
                // Guestã¯ä¸»å‚¬è€…ã®é¸æŠã‚’å¾…ã¤
                showGuestWaitingMessage();
                return;
            }
            
            selectedMode = mode;
            updateSelectedMode(mode, false);
            
            // Ownerã®é¸æŠã‚’é€šçŸ¥
            if (socket) {
                socket.emit('select_mode', {
                    roomId: roomId,
                    mode: mode
                });
            }
        }
        
        function updateSelectedMode(mode, isForced = false) {
            // å…¨ã‚«ãƒ¼ãƒ‰ã®é¸æŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.wa-mode-card-large').forEach(card => {
                card.classList.remove('selected');
            });
            
            // é¸æŠã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            document.querySelector(`[data-mode="${mode}"]`).classList.add('selected');
            
            // ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹è¡¨ç¤º
            showModeGuidance(mode, isForced);
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            const startBtn = document.getElementById('startBtn');
            const startIcon = document.getElementById('startIcon');
            const startText = document.getElementById('startText');
            const statusSelection = document.getElementById('statusSelection');
            
            if (mode === 'learning') {
                startIcon.textContent = 'ğŸŒ¸';
                startText.textContent = 'å­¦ç¿’ã®æ‰‰ã‚’é–‹ã';
                statusSelection.textContent = 'å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰';
                statusSelection.style.color = 'var(--take)';
            } else if (mode === 'quiz') {
                startIcon.textContent = 'âš”ï¸';
                startText.textContent = 'å¯¾æˆ¦ã®å ´ã¸å‘ã‹ã†';
                statusSelection.textContent = 'ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰';
                statusSelection.style.color = 'var(--enjhi)';
            }
            
            startBtn.disabled = false;
            startBtn.classList.add('wa-pulse');
        }
        
        function showModeGuidance(mode, isForced) {
            const guidance = document.getElementById('selectionGuidance');
            const guidanceTitle = document.getElementById('guidanceTitle');
            const guidanceContent = document.getElementById('guidanceContent');
            
            guidance.style.display = 'block';
            
            if (mode === 'learning') {
                guidanceTitle.textContent = 'ğŸŒ¸ å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦';
                if (isForced) {
                    guidanceContent.textContent = 
                        'ä¸»å‚¬è€…ãŒå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¾ã—ãŸã€‚ç¾ã—ã„ç‰©èªã‚’å…±ã«èª­ã¿é€²ã‚ã€çŸ¥è­˜ã‚’æ·±ã‚ã¦ã¾ã„ã‚Šã¾ã—ã‚‡ã†ã€‚';
                } else {
                    guidanceContent.textContent = 
                        'å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€ä¸»å‚¬è€…ã®æ“ä½œã«åˆã‚ã›ã¦å‚åŠ è€…ã®ç”»é¢ã‚‚åŒæœŸã•ã‚Œã¾ã™ã€‚ç¾ã—ã„ç‰©èªã‚’å…±ã«èª­ã¿é€²ã‚ã€çŸ¥è­˜ã‚’æ·±ã‚ã¦ã¾ã„ã‚Šã¾ã—ã‚‡ã†ã€‚';
                }
            } else if (mode === 'quiz') {
                guidanceTitle.textContent = 'âš”ï¸ ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦';
                if (isForced) {
                    guidanceContent.textContent = 
                        'ä¸»å‚¬è€…ãŒã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¾ã—ãŸã€‚å­¦ã‚“ã çŸ¥è­˜ã‚’æ­¦å™¨ã«ã€è¯éº—ãªã‚‹å¯¾æˆ¦ã«æŒ‘ã¿ã¾ã—ã‚‡ã†ã€‚';
                } else {
                    guidanceContent.textContent = 
                        'ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¯¾æˆ¦ã‚’è¡Œã„ã¾ã™ã€‚åˆ¶é™æ™‚é–“å†…ã«æ­£è§£ã‚’ç›®æŒ‡ã—ã€äº’ã„ã®å®ŸåŠ›ã‚’ç«¶ã„åˆã„ã¾ã—ã‚‡ã†ã€‚';
                }
            }
        }
        
        function showGuestWaitingMessage() {
            // GuestãŒç›´æ¥ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã‚ˆã†ã¨ã—ãŸå ´åˆã®æ¡ˆå†…
            const modal = document.createElement('div');
            modal.className = 'wa-modal active';
            modal.innerHTML = `
                <div class="wa-modal-content">
                    <h3 style="color: var(--ai); margin-bottom: 1rem;">ğŸ‹ å‚åŠ è€…ã®çš†æ§˜</h3>
                    <p style="margin-bottom: 1.5rem;">
                        å­¦ç¿’æ–¹å¼ã¯ä¸»å‚¬è€…ãŒé¸æŠã„ãŸã—ã¾ã™ã€‚<br>
                        ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚
                    </p>
                    <button class="wa-btn wa-btn-primary" onclick="this.closest('.wa-modal').remove()">
                        æ‰¿çŸ¥ã„ãŸã—ã¾ã—ãŸ
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // é¸æŠã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ‰é–‹å§‹
        function startSelectedMode() {
            if (!selectedMode) {
                alert('ã¾ãšå­¦ç¿’æ–¹å¼ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            if (socket) {
                socket.emit('start_mode', {
                    roomId: roomId,
                    mode: selectedMode,
                    playerName: playerName,
                    role: userRole
                });
            }
            
            // ç›´æ¥é·ç§»
            proceedToSelectedMode(selectedMode);
        }
        
        function proceedToSelectedMode(mode, data = {}) {
            const params = new URLSearchParams({
                role: userRole,
                roomId: roomId,
                playerName: playerName
            });
            
            if (mode === 'learning') {
                window.location.href = `learning.html?${params.toString()}`;
            } else if (mode === 'quiz') {
                window.location.href = `matching.html?${params.toString()}`;
            }
        }
        
        // å¾…æ©Ÿæ™‚é–“ã‚¿ã‚¤ãƒãƒ¼
        function startWaitingTimer() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                document.getElementById('waitingTime').textContent = `${minutes}:${seconds}`;
            }, 1000);
        }
        
        // å­£ç¯€è£…é£¾ã®ç”Ÿæˆ
        function generateSeasonalElements() {
            const container = document.getElementById('seasonalDecoration');
            const elements = [
                { class: 'sakura-petal', count: 4 },
                { class: 'momiji-leaf', count: 2 }
            ];
            
            elements.forEach(({ class: className, count }) => {
                for (let i = 0; i < count; i++) {
                    const element = document.createElement('div');
                    element.className = className;
                    element.style.left = Math.random() * 100 + '%';
                    element.style.animationDelay = Math.random() * 8 + 's';
                    element.style.animationDuration = (6 + Math.random() * 4) + 's';
                    container.appendChild(element);
                }
            });
        }
        
        function goBack() {
            if (socket) {
                socket.disconnect();
            }
            window.location.href = `lobby.html?role=${userRole}`;
        }
        
        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
        document.addEventListener('keydown', (e) => {
            switch (e.key) {
                case '1':
                    if (userRole === 'owner') selectMode('learning');
                    break;
                case '2':
                    if (userRole === 'owner') selectMode('quiz');
                    break;
                case 'Enter':
                    if (selectedMode) {
                        startSelectedMode();
                    }
                    break;
                case 'Escape':
                    goBack();
                    break;
            }
        });
        
        // ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        window.addEventListener('beforeunload', () => {
            if (socket) {
                socket.disconnect();
            }
        });
    </script>

    <style>
        .wa-section-title {
            font-family: var(--font-accent);
            font-size: 1.8rem;
            color: var(--enjhi);
            text-align: center;
            margin-bottom: var(--spacing-xl);
            text-shadow: 1px 1px 0px rgba(178, 45, 53, 0.1);
        }

        .wa-room-info {
            background: var(--gradient-sakura);
            border: 2px solid var(--enjhi);
            border-radius: var(--border-radius-large);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xxl);
        }

        .wa-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
        }

        .wa-info-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background: rgba(255, 255, 255, 0.3);
            border-radius: var(--border-radius);
        }

        .wa-info-icon {
            font-size: 1.5rem;
            width: 24px;
            text-align: center;
        }

        .wa-info-label {
            font-family: var(--font-ui);
            font-weight: 600;
            color: var(--sumi);
            min-width: 50px;
        }

        .wa-info-value {
            font-family: var(--font-main);
            color: var(--enjhi);
            font-weight: 500;
        }

        .wa-mode-cards-large {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: var(--spacing-xxl);
            margin: var(--spacing-xxl) 0;
        }

        .wa-mode-card-large {
            background: var(--gradient-washi);
            border: 3px solid var(--ai);
            border-radius: var(--border-radius-large);
            padding: var(--spacing-xxl);
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .wa-mode-card-large::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(178, 45, 53, 0.1) 0%, transparent 70%);
            transform: scale(0);
            transition: transform 0.8s ease;
        }

        .wa-mode-card-large:hover::before {
            transform: scale(1);
        }

        .wa-mode-card-large:hover {
            transform: translateY(-10px) scale(1.03);
            border-color: var(--enjhi);
            box-shadow: 
                var(--shadow-strong),
                0 0 40px rgba(178, 45, 53, 0.3);
        }

        .wa-mode-card-large.selected {
            background: var(--gradient-sakura);
            border-color: var(--enjhi);
            border-width: 4px;
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                var(--shadow-strong),
                0 0 30px rgba(178, 45, 53, 0.4);
        }

        .wa-mode-decoration {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .wa-decoration-element {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: decorationFloat 6s ease-in-out infinite;
        }

        .wa-decoration-element:nth-child(1) {
            top: 10%;
            right: 15%;
            animation-delay: 0s;
        }

        .wa-decoration-element:nth-child(2) {
            bottom: 20%;
            left: 10%;
            animation-delay: 2s;
        }

        .wa-decoration-element:nth-child(3) {
            top: 60%;
            right: 10%;
            animation-delay: 4s;
        }

        @keyframes decorationFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.1; }
            50% { transform: translateY(-10px) rotate(180deg); opacity: 0.3; }
        }

        .wa-mode-icon-large {
            font-size: 5rem;
            margin-bottom: var(--spacing-lg);
            animation: iconPulse 3s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .wa-mode-title-large {
            font-family: var(--font-accent);
            font-size: 2rem;
            font-weight: 800;
            color: var(--enjhi);
            margin-bottom: var(--spacing-sm);
            text-shadow: 2px 2px 0px rgba(178, 45, 53, 0.1);
        }

        .wa-mode-subtitle {
            font-family: var(--font-main);
            font-size: 1.1rem;
            color: var(--ai);
            margin-bottom: var(--spacing-lg);
            font-style: italic;
        }

        .wa-mode-description-large {
            font-family: var(--font-main);
            font-size: 1rem;
            line-height: 1.8;
            color: var(--sumi);
            margin-bottom: var(--spacing-lg);
            text-align: center;
        }

        .wa-mode-details {
            width: 100%;
            margin-bottom: var(--spacing-lg);
        }

        .wa-mode-details h4 {
            font-family: var(--font-ui);
            color: var(--enjhi);
            margin-bottom: var(--spacing-md);
            text-align: center;
        }

        .wa-subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--spacing-xs);
        }

        .wa-subject-item {
            background: rgba(22, 94, 131, 0.1);
            color: var(--ai);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius);
            font-size: 0.85rem;
            text-align: center;
            border: 1px solid rgba(22, 94, 131, 0.2);
        }

        .wa-battle-info {
            display: flex;
            justify-content: space-around;
            gap: var(--spacing-md);
        }

        .wa-battle-rule {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .wa-rule-number {
            font-size: 2rem;
            font-weight: 800;
            color: var(--enjhi);
            line-height: 1;
        }

        .wa-rule-text {
            font-size: 0.9rem;
            color: var(--sumi);
        }

        .wa-mode-features-large {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--spacing-sm);
            margin-top: auto;
        }

        .wa-feature-large {
            background: rgba(47, 82, 51, 0.1);
            color: var(--take);
            padding: var(--spacing-sm);
            border-radius: var(--border-radius);
            font-size: 0.85rem;
            text-align: center;
            border: 1px solid rgba(47, 82, 51, 0.2);
            font-weight: 500;
        }

        .wa-selection-guidance {
            margin: var(--spacing-xl) 0;
        }

        .wa-btn-group-large {
            display: flex;
            gap: var(--spacing-lg);
            justify-content: center;
            margin: var(--spacing-xxl) 0;
        }

        .wa-btn-large {
            padding: var(--spacing-lg) var(--spacing-xxl);
            font-size: 1.1rem;
        }

        .wa-notices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
            margin: var(--spacing-xxl) 0;
        }

        .wa-notice-card {
            background: var(--gradient-washi);
            border: 2px solid var(--take);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
        }

        .wa-notice-card h4 {
            color: var(--take);
            margin-bottom: var(--spacing-md);
            font-family: var(--font-ui);
        }

        .wa-notice-card ul {
            padding-left: var(--spacing-lg);
            list-style-type: none;
        }

        .wa-notice-card li {
            position: relative;
            margin-bottom: var(--spacing-sm);
            color: var(--sumi);
            line-height: 1.6;
        }

        .wa-notice-card li::before {
            content: 'ğŸŒ¸';
            position: absolute;
            left: -1.5rem;
            top: 0;
        }

        .wa-status-dot.connected {
            background: var(--take);
            animation: statusPulse 2s infinite;
        }

        @media (max-width: 768px) {
            .wa-mode-cards-large {
                grid-template-columns: 1fr;
                gap: var(--spacing-xl);
            }
            
            .wa-mode-card-large {
                min-height: 400px;
                padding: var(--spacing-xl);
            }
            
            .wa-mode-icon-large {
                font-size: 4rem;
            }
            
            .wa-mode-title-large {
                font-size: 1.8rem;
            }
            
            .wa-info-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .wa-btn-group-large {
                flex-direction: column;
            }
            
            .wa-notices {
                grid-template-columns: 1fr;
            }
            
            .wa-battle-info {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</body>
</html>
